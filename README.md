# ACS AEM Commons

[![Maven Central](https://img.shields.io/maven-central/v/com.adobe.acs/acs-aem-commons-all)](https://central.sonatype.com/artifact/com.adobe.acs/acs-aem-commons-all)
[![Build Status](https://github.com/Adobe-Consulting-Services/acs-aem-commons/actions/workflows/maven.yml/badge.svg)](https://github.com/Adobe-Consulting-Services/acs-aem-commons/actions)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=Adobe-Consulting-Services_acs-aem-commons&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=Adobe-Consulting-Services_acs-aem-commons)
[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=Adobe-Consulting-Services_acs-aem-commons&metric=coverage)](https://sonarcloud.io/summary/new_code?id=Adobe-Consulting-Services_acs-aem-commons)
[![Bugs](https://sonarcloud.io/api/project_badges/measure?project=Adobe-Consulting-Services_acs-aem-commons&metric=bugs)](https://sonarcloud.io/summary/new_code?id=Adobe-Consulting-Services_acs-aem-commons)

This project is a unified collection of AEM/CQ code generated by the AEM consulting practice.

## Using

Please refer to [Add ACS AEM Commons to your AEM Maven project](https://adobe-consulting-services.github.io/acs-aem-commons/pages/maven.html) for how to install its package and use its API.

### Prerequisites

The prerequisites are listed in [Compatibility](https://adobe-consulting-services.github.io/acs-aem-commons/pages/compatibility.html).

### Distribution

+ Binaries (Maven artifacts) and source code are available from Maven central: [https://central.sonatype.com/artifact/com.adobe.acs/acs-aem-commons-all](https://central.sonatype.com/artifact/com.adobe.acs/acs-aem-commons-all)
+ Github releases contains only the source code: [https://github.com/Adobe-Consulting-Services/acs-aem-commons/releases](https://github.com/Adobe-Consulting-Services/acs-aem-commons/releases)


## Building

This project uses Maven for building. Common commands:

From the root directory, run `mvn -PautoInstallPackage clean install` (for AEM 6.5) or `mvn -PautoInstallPackage,cloud clean install` (for AEMaaCS) to build the bundles and content packages and install the container package to an AEM instance.

From the bundle directory, run `mvn -PautoInstallBundle clean install` to build *just* the bundle and install to an AEM instance. In addition there is the profile `autoInstallUiAppsPackage` to just install the `ui.apps` package to AEM.

The Maven profile `cloud` is used to both build both the AEMaaCS and the AEM 6.5 packages/bundles as well as to optionally install the version targeted for AEMaaCS (with the additional profile `autoInstallPackage` or `autoInstallUiPackage`). It is automatically active when no other profile is activated via command line or `settings,.xml`. 

To build only the version for AEM 6.5 (without using any other profiles) use the command line option `-P \!cloud` [to deactivate the default profile `cloud`](https://maven.apache.org/guides/introduction/introduction-to-profiles.html#deactivating-a-profile).

### Deploying with VLT

To use vlt with this project, first build and install the package to your local AEM instance as described above. Then cd to `content/src/main/content/jcr_root` and run

    vlt --credentials admin:admin checkout -f ../META-INF/vault/filter.xml --force http://localhost:4502/crx

Once the working copy is created, you can use the normal ``vlt up`` and ``vlt ci`` commands.

### Specifying AEM Host/Port

The AEM host and port can be specified on the command line with:
mvn -Dcrx.host=otherhost -Dcrx.port=5502 <goals>

### Rules

* Spaces, not tabs.
* Provide documentation in the parent org GH project: https://github.com/Adobe-Consulting-Services/adobe-consulting-services.github.io
* Target AEM as a Cloud Service. AEM 6.5.x only features can still be contributed, but please create a Feature Review Github Issue before working on them to ensure they will accepted. Check the [compatibility table](http://adobe-consulting-services.github.io/acs-aem-commons/pages/compatibility.html) for compatibility of older versions.
* API classes and interfaces must have JavaDocs. Not necessary for implementation classes.
* Don't use author tags. This is a community project.

## Want commit rights?

* Create an issue.

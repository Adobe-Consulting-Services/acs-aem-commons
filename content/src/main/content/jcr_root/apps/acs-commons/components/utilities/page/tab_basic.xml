<?xml version="1.0" encoding="UTF-8"?>
<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
          jcr:primaryType="cq:Panel"
          title="Basic">
            <vanityPath
                    jcr:primaryType="cq:Widget"
                    cls="cq-propsdialog-vanityurl"
                    fieldLabel="Vanity URL"
                    name="./sling:vanityPath"
                    xtype="multifield">
                <fieldConfig
                        jcr:primaryType="nt:unstructured"
                        allowBlank="{Boolean}false"
                        xtype="textfield">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            change="function( f, v, o ){&#xa;    var dialog = f.findParentByType(&quot;dialog&quot;);&#xa;    var dialogPath = dialog.path;&#xa;    console.debug( dialogPath + &quot; &quot; + v );&#xa;    var cqresponse = CQ.HTTP.get(&quot;/bin/wcm/duplicateVanityCheck?vanityPath=&quot;+v+&quot;&amp;amp;pagePath=&quot;+dialogPath);&#xa;&#xa;    var json = eval(cqresponse);&#xa;    var vanitypathsjson = json.responseText;&#xa;    var JSONObj = JSON.parse(vanitypathsjson);&#xa;    var jsonVanityPath = JSONObj.vanitypaths;&#xa;    console.debug( jsonVanityPath.length );&#xa;&#xa;    if (jsonVanityPath.length == 0) {&#xa;        f.clearInvalid();&#xa;    } else {&#xa;        // check whether the path of the page where the vanity path is defined matches the dialog's path&#xa;        // which means that the vanity path is legal&#xa;        f.markInvalid( &quot;The Vanity Path: &quot; + v + &quot; already exists&quot; );&#xa;        CQ.Ext.Msg.alert(&quot;Status&quot;, &quot;The Vanity Path: &quot; + v + &quot; already exists&quot;);&#xa;    }&#xa;&#xa;//alert( &quot;Checking Duplicate&quot; );&#xa;}"/>
                </fieldConfig>
            </vanityPath>
</jcr:root>
